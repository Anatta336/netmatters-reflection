@use "../icons";
@use "../icons/variables" as icon-variables;
@use "../theme";
@use "../utility";

$card-background-colour: #fff;
$card-border-colour: #ccc;
$card-shadow-colour: rgba(0, 0, 0, 0.15);

$text-colour: theme.$brand-background-colour;
$button-text-colour: #fff;

$heading-size: utility.px-to-rem(18px);
$para-size: utility.px-to-rem(13px);
$button-size: utility.px-to-rem(17px);

$icon-colour: #fff;
$icon-background-size: utility.px-to-rem(60px);
$icon-size: 1rem;

$button-width: 8rem;
$button-height: 3rem;

#services {
    margin: 2rem 1rem;
    
    a {
        @include utility.margin-x-center;

        display: flex;
        flex-direction: column;

        padding: 1.5em;
        margin-top: 0;
        margin-bottom: 2rem;

        text-decoration: none;
        color: $text-colour;
        text-align: center;

        background-color: $card-background-colour;
        border: 1px solid $card-border-colour;
        @include utility.rounded-corners;

        box-shadow: 0 0 30px $card-shadow-colour;
    }

    h2 {
        font-size: $heading-size;
        font-weight: 400;
    }

    p {
        font-size: $para-size;
        line-height: 1.375rem;
    }

    .call-to-action {
        // null $background-colour so the button mixin doesn't generate a
        // background-color property. It will be set on a per-card basis
        // depending on the card's id.
        @include utility.button(
            $background-colour: null,
            $text-colour: $button-text-colour,
            $font-size: $button-size,
            $width: $button-width,
            $height: $button-height
        );

        // as this is a flex item, auto for top margin will push it to bottom of container
        margin: auto auto 0;
    }

    // generate a small horizontal line after the h2 element
    h2::after {
        @include utility.short-horizontal-line;
    }

    // set button's colour based on the id of the service card it's within
    // (assumes that all cards have an id listed in $service-colours)
    @each $service-name, $colour in theme.$service-colours {
        .#{$service-name} .call-to-action {
            background-color: $colour;
        }
    }

    // generate icon appropriate to the id of the service card, placing
    // the icon as a ::before pseudo-element on the card's h2.
    @each $service-name, $icon-name in theme.$service-icons {
        $icon-unicode: icons.icon-unicode-from-name($icon-name);
        $icon-background-colour: theme.get-colour-for-service($service-name);

        .#{$service-name} h2::before {
            @include icons.icon;
            @include utility.oval;

            content: $icon-unicode;
            color: $icon-colour;

            display: block;
            box-sizing: border-box;
            width: $icon-background-size;
            height: $icon-background-size;
            background-color: $icon-background-colour;

            margin: 0 auto 1.3rem;

            // vertically center icon within the element
            padding-top: ($icon-background-size - $icon-size) * 0.5;
        }
    }
    
    // past extra-small first 3 cards remain as they are but rest are put into a 2x2 grid
    @include utility.above-breakpoint("small") {
        @include utility.margin-x-center;
        width: utility.px-to-rem(750px);

        .other-services {
            @include utility.wrapped-flex;

            // negative margin reverses effect of external margins from children
            margin: 0 -1rem;

            // set up direct children as flex items
            > * {
                margin: 1rem;
                flex-basis: 18rem;
                flex-grow: 1;
            }
        }
    }

    @include utility.above-breakpoint("medium") {
        width: utility.px-to-rem(970px);

        .top-services {
            @include utility.wrapped-flex;
            margin: 0 -1rem;

            > * {
                margin: 1rem;
                flex-basis: 15rem;
                flex-grow: 1;
            }
        }
    }

    @include utility.above-breakpoint("large") {
        width: utility.px-to-rem(1200px);

        // other-services should form row of 4 at this breakpoint,
        // so reduce their flex-basis to allow them to fit.
        .other-services > * {
            flex-basis: 13rem;
        }
    }
}
